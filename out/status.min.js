function create(e){status=vc.window.createStatusBarItem(vc.StatusBarAlignment.Left,1),cfg=conf.load(),e.subscriptions.push(status),refresh()}function refresh(){usrCap=1/0,usrCapL=1/0,wspCap=1/0,wspCapL=1/0,splitTooltip=!1,cfg=conf.load(),cfg.status.displayProgress&&("Disabled"==cfg.status.levelDisplayType&&(displayMode=-1),"Bar"==cfg.status.displayProgress&&(displayMode=1),"Percentage"==cfg.status.displayProgress&&(displayMode=2)),cfg.status.displayPercentPrecision&&(displayDeci=cfg.status.displayPercentPrecision),cfg.status.displayBarLength&&(displaySize=cfg.status.displayBarLength),cfg.status.levelDisplayType&&("Disabled"==cfg.status.levelDisplayType&&(levelMode=-1),"Level"==cfg.status.levelDisplayType&&(levelMode=1),"Level (Short)"==cfg.status.levelDisplayType&&(levelMode=2),"Level (Type)"==cfg.status.levelDisplayType&&(levelMode=3),"Level (Short Type)"==cfg.status.levelDisplayType&&(levelMode=4),"Percentage"==cfg.status.levelDisplayType&&(levelMode=5),"Grade"==cfg.status.levelDisplayType&&(levelMode=6)),cfg.status.levelPercentPrecision&&(levelDeci=cfg.status.levelPercentPrecision),cfg.status.displayExperienceType&&(levelTarget=cfg.status.displayExperienceType),cfg.user.levelMod&&(usrMod=cfg.user.levelMod),cfg.workspace.levelMod&&(wspMod=cfg.workspace.levelMod),cfg.user.levelModLanguage&&(usrModLang=cfg.user.levelModLanguage),cfg.workspace.levelModLanguage&&(wspModLang=cfg.workspace.levelModLanguage),cfg.caps.mainUser>0&&(usrCap=cfg.caps.mainUser),cfg.caps.userLanguage>0&&(usrCapL=cfg.caps.userLanguage),cfg.caps.mainWorkspace>0&&(wspCap=cfg.caps.mainWorkspace),cfg.caps.workspaceLanguage>0&&(wspCapL=cfg.caps.workspaceLanguage),cfg.tooltip.enableUser&&cfg.tooltip.enableWorkspace&&(cfg.user.tracking||cfg.user.trackLanguage)&&(cfg.workspace.tracking||cfg.workspace.trackLanguage)&&(splitTooltip=!0),cfg.other.bigNumberFormat&&("Normal"==cfg.other.bigNumberFormat&&(numberStyle=1),"SI"==cfg.other.bigNumberFormat&&(numberStyle=2)),1!=levelTarget&&3!=levelTarget||(status.command="code-levels.openuserview"),2!=levelTarget&&4!=levelTarget||(status.command="code-levels.openworkspaceview"),cfg.tooltip.experienceSuffix&&(expSuffix=cfg.tooltip.experienceSuffix),update(0)}function update(e,a=!1){status.show();var l="";const t=new vc.MarkdownString;t.supportHtml=!0,t.value="",cfg.user.tracking&&a&&data.usr&&void 0!==typeof data.usr.exp&&(data.usr.exp+=e),cfg.workspace.tracking&&a&&data.wsp&&void 0!==typeof data.wsp.exp&&(data.wsp.exp+=e),cfg.user.trackLanguage&&a&&data.usr&&(void 0===data.usr.langs[a]&&(data.usr.langs[a]={exp:0,lvl:1}),data.usr.langs[a].exp+=e),cfg.workspace.trackLanguage&&a&&data.wsp&&(void 0===data.wsp.langs[a]&&(data.wsp.langs[a]={exp:0,lvl:1}),data.wsp.langs[a].exp+=e);var s=0,r=0,c=1/0,i=5;switch(levelTarget){case 1:data.usr.exp&&data.usr.lvl&&cfg.user.tracking&&(s=data.usr.exp,r=data.usr.lvl,i=usrMod,c=usrCap);break;case 2:data.wsp.exp&&data.wsp.lvl&&cfg.workspace.tracking&&(s=data.wsp.exp,r=data.wsp.lvl,i=wspMod,c=wspCap);break;case 3:0!=a&&data.usr.langs[a]&&data.usr.langs[a].exp&&data.usr.langs[a].lvl&&cfg.user.trackLanguage&&(s=data.usr.langs[a].exp,r=data.usr.langs[a].lvl,i=usrModLang,c=usrCapL);break;case 4:0!=a&&data.wsp.langs[a]&&data.wsp.langs[a].exp&&data.usr.langs[a].lvl&&cfg.workspace.trackLanguage&&(s=data.wsp.langs[a].exp,r=data.wsp.langs[a].lvl,i=wspModLang,c=wspCapL)}if(1==displayMode){let e=Math.min(r,c-1);l+=bar(e,i,s,displaySize)}if(2==displayMode){let e=Math.min(r,c-1),a=Math.min(levels.calculatePct(e,i,s,displayDeci-1),100),t=parseFloat(a).toFixed(displayDeci-1);if(Math.abs(a)<10){let e=t.toString();pctF="0"+e}else pctF=t;l+=pctF,l+="% | "}let g=!1;if((3==levelTarget&&!a||4==levelTarget&&!a)&&(g=!0),!g){if(1==levelMode&&r>0){let e=Math.min(r,c);l+="Lv. "+Math.min(e,c)}if(2==levelMode&&r>0){let e=Math.min(r,c);l+=Math.min(e,c)}if(3==levelMode&&r>0){let e=Math.min(r,c);switch(levelTarget){case 1:l+="ULv"+Math.min(e,c);break;case 2:l+="WLv"+Math.min(e,c);break;case 3:l+="ULL"+Math.min(e,c);break;case 4:l+="WLL"+Math.min(e,c)}}if(4==levelMode&&r>0){let e=Math.min(r,c);switch(levelTarget){case 1:l+="U"+Math.min(e,c);break;case 2:l+="W"+Math.min(e,c);break;case 3:l+="u"+Math.min(e,c);break;case 4:l+="w"+Math.min(e,c)}}if(5==levelMode&&r>0){let e=Math.min(r,c-1),a=Math.min(levels.calculatePct(e,i,s,levelDeci-1),100),t=parseFloat(a).toFixed(levelDeci-1);if(Math.abs(a)<10){let e=t.toString();pctF="0"+e}else pctF=t;l+=pctF,l+="%"}if(6==levelMode&&r>1){let e=Math.min(r,c);l+=grade.get(e)}}if(cfg.status.levelReadySymbol&&r<c&&r>0){let e=levels.calculateReq(r,i);s>=e&&(l+=String(cfg.status.levelReadySymbolType))}if(status.text=l,cfg.tooltip.enableTooltip){if(cfg.tooltip.enableUser&&data.usr&&cfg.user.tracking){if(data.usr.lvl&&!cfg.grades.enableForUser){let e=Math.min(data.usr.lvl,usrCap);t.value+="<b><u><code>User Lv. "+String(e)+"</code></u></b>"}if(data.usr.lvl&&cfg.grades.enableForUser){let e=Math.min(data.usr.lvl,usrCap),a=grade.get(e);t.value+="<b><u><code>User ("+String(a)+")</code></u></b>"}if(data.usr.exp&&data.usr.lvl){let e,a=Math.min(data.usr.lvl,usrCap),l=data.usr.exp,s=levels.calculateReq(a-1,usrMod),r=levels.calculateReq(a,usrMod),c=number.format(l-s,numberStyle,!0),i=number.format(r-s,numberStyle,!0);if(e=a>=usrCap?cfg.grades.enableForUser?"<b>MAX</b>":"<b>MAX LEVEL</b>":"<b>"+String(c)+"</b> / "+String(i)+expSuffix,t.value+="<br>"+e,cfg.tooltip.enableUserTotal){let e=number.format(l,numberStyle,!0);t.value+="<br><code>"+String(e)+" total</code>"}}if(cfg.tooltip.enableUserLanguage&&data.usr.langs&&a&&cfg.user.trackLanguage&&data.usr.langs[a]&&data.usr.langs[a].exp&&data.usr.langs[a].lvl){let e,l=Math.min(data.usr.langs[a].lvl,usrCapL),s=levels.calculatePct(data.usr.langs[a].lvl,usrModLang,data.usr.langs[a].exp,0);e=l>=usrCapL?"MAX":Math.min(s,99)+"%";let r=nlang.prettify(a);if(cfg.grades.enableForUserLanguage){let a=grade.get(l);t.value+="<br><i><b>"+r+"</b> | "+String(a)+" ("+String(e)+")</i>"}else t.value+="<br><i><b>"+r+"</b> Lv. "+String(l)+" ("+String(e)+")</i>"}}if(splitTooltip&&(t.value+="<br>════════════════════<br>"),cfg.tooltip.enableWorkspace&&data.wsp&&cfg.workspace.tracking){if(data.wsp.lvl&&!cfg.grades.enableForWorkspace){let e=Math.min(data.wsp.lvl,wspCap);t.value+="<b><u><code>Workspace Lv. "+String(e)+"</code></u></b>"}if(data.wsp.lvl&&cfg.grades.enableForWorkspace){let e=Math.min(data.wsp.lvl,wspCap),a=grade.get(e);t.value+="<b><u><code>Workspace ("+String(a)+")</code></u></b>"}if(data.wsp.exp&&data.wsp.lvl){let e,a=Math.min(data.wsp.lvl,wspCap),l=data.wsp.exp,s=levels.calculateReq(a-1,wspMod),r=levels.calculateReq(a,wspMod),c=number.format(l-s,numberStyle,!0),i=number.format(r-s,numberStyle,!0);if(e=a>=wspCap?cfg.grades.enableForWorkspace?"<b>MAX</b>":"<b>MAX LEVEL</b>":"<b>"+String(c)+"</b> / "+String(i)+expSuffix,t.value+="<br>"+e,cfg.tooltip.enableWorkspaceTotal){let e=number.format(l,numberStyle,!0);t.value+="<br><code>"+String(e)+" total</code>"}}if(cfg.tooltip.enableWorkspaceLanguage&&data.wsp.langs&&a&&cfg.workspace.trackLanguage&&data.wsp.langs[a]&&data.wsp.langs[a].exp&&data.wsp.langs[a].lvl){let e,l=Math.min(data.wsp.langs[a].lvl,wspCapL),s=levels.calculatePct(data.wsp.langs[a].lvl,wspModLang,data.wsp.langs[a].exp,0);e=l>=wspCapL?"MAX":Math.min(s,99)+"%";let r=nlang.prettify(a);if(cfg.grades.enableForWorkspaceLanguage){let a=grade.get(l);t.value+="<br><i><b>"+r+"</b> | "+String(a)+" ("+String(e)+")</i>"}else t.value+="<br><i><b>"+r+"</b> Lv. "+String(l)+" ("+String(e)+")</i>"}}status.tooltip=t}}function bar(e,a=5,l,t=10){var s=0;let r=levels.calculateReq(e,a),c=levels.calculateReq(e-1,a),i=r-c,g=l-c;var p="▕";if(cfg.status.advancedBar){var n=8*t,u=t;for(let e=0;e<n;e++)g>=i/n*(e+1)&&s++;for(let e=0;e<Math.floor(s/8);e++)p+="█",u--;var o=s%8;switch(o){case 0:break;case 1:if(u--,cfg.status.verticalBarFill){p+="▁";break}p+="▏";break;case 2:if(u--,cfg.status.verticalBarFill){p+="▂";break}p+="▎";break;case 3:if(u--,cfg.status.verticalBarFill){p+="▃";break}p+="▍";break;case 4:if(u--,cfg.status.verticalBarFill){p+="▄";break}p+="▌";break;case 5:if(u--,cfg.status.verticalBarFill){p+="▅";break}p+="▋";break;case 6:if(u--,cfg.status.verticalBarFill){p+="▆";break}p+="▊";break;case 7:if(u--,cfg.status.verticalBarFill){p+="▇";break}p+="▉"}for(let e=0;e<u;e++)p+="       ";return p+="▏",p}n=3*t,u=t;for(let e=0;e<n;e++)g>=i/n*(e+1)&&s++;for(let e=0;e<Math.floor(s/3);e++)p+="█",u--;o=s%3;switch(o){case 0:break;case 1:p+="▒",u--;break;case 2:p+="▓",u--}for(let e=0;e<u;e++)p+="▁";return p+="▏",p}const vc=require("vscode"),conf=require("./config.min.js"),data=require("./data.min.js"),number=require("./number.min.js"),levels=require("./levels.min.js"),nlang=require("./nicelang.min.js"),grade=require("./nicelevel.min.js");let status;var cfg={};let displayMode=0,displayDeci=2,displaySize=10,levelMode=0,levelDeci=1,levelTarget=0,usrMod=10,usrModLang=5,wspMod=10,wspModLang=5,expSuffix="",usrCap=1/0,usrCapL=1/0,wspCap=1/0,wspCapL=1/0,splitTooltip=!1,numberStyle=1;module.exports={create:create,refresh:refresh,update:update,bar:bar};