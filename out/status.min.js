function create(e){status=vc.window.createStatusBarItem(vc.StatusBarAlignment.Left,1),cfg=conf.load(),e.subscriptions.push(status),refresh()}function refresh(){usrCap=1/0,usrCapL=1/0,wspCap=1/0,wspCapL=1/0,splitTooltip=!1,cfg=conf.load(),cfg.status.displayProgress&&("Disabled"==cfg.status.levelDisplayType&&(displayMode=-1),"Bar"==cfg.status.displayProgress&&(displayMode=1),"Percentage"==cfg.status.displayProgress&&(displayMode=2)),cfg.status.displayPercentPrecision&&(displayDeci=cfg.status.displayPercentPrecision),cfg.status.displayBarLength&&(displaySize=cfg.status.displayBarLength),cfg.status.levelDisplayType&&("Disabled"==cfg.status.levelDisplayType&&(levelMode=-1),"Level"==cfg.status.levelDisplayType&&(levelMode=1),"Level (Short)"==cfg.status.levelDisplayType&&(levelMode=2),"Level (Type)"==cfg.status.levelDisplayType&&(levelMode=3),"Level (Short Type)"==cfg.status.levelDisplayType&&(levelMode=4),"Percentage"==cfg.status.levelDisplayType&&(levelMode=5)),cfg.status.levelPercentPrecision&&(levelDeci=cfg.status.levelPercentPrecision),cfg.status.displayExperienceType&&(levelTarget=cfg.status.displayExperienceType),cfg.user.levelMod&&(usrMod=cfg.user.levelMod),cfg.workspace.levelMod&&(wspMod=cfg.workspace.levelMod),cfg.user.levelModLanguage&&(usrModLang=cfg.user.levelModLanguage),cfg.workspace.levelModLanguage&&(wspModLang=cfg.workspace.levelModLanguage),cfg.caps.mainUser>0&&(usrCap=cfg.caps.mainUser),cfg.caps.userLanguage>0&&(usrCapL=cfg.caps.userLanguage),cfg.caps.mainWorkspace>0&&(wspCap=cfg.caps.mainWorkspace),cfg.caps.workspaceLanguage>0&&(wspCapL=cfg.caps.workspaceLanguage),cfg.tooltip.enableUser&&cfg.tooltip.enableWorkspace&&(cfg.user.tracking||cfg.user.trackLanguage)&&(cfg.workspace.tracking||cfg.workspace.trackLanguage)&&(splitTooltip=!0),cfg.other.bigNumberFormat&&("Normal"==cfg.other.bigNumberFormat&&(numberStyle=1),"SI"==cfg.other.bigNumberFormat&&(numberStyle=2)),1!=levelTarget&&3!=levelTarget||(status.command="code-levels.openuserview"),2!=levelTarget&&4!=levelTarget||(status.command="code-levels.openworkspaceview"),cfg.tooltip.experienceSuffix&&(expSuffix=cfg.tooltip.experienceSuffix),update(0)}function update(e,a=!1){status.show();var t="";const s=new vc.MarkdownString;s.supportHtml=!0,s.value="",cfg.user.tracking&&a&&data.usr&&void 0!==typeof data.usr.exp&&(data.usr.exp+=e),cfg.workspace.tracking&&a&&data.wsp&&void 0!==typeof data.wsp.exp&&(data.wsp.exp+=e),cfg.user.trackLanguage&&a&&data.usr&&(void 0===data.usr.langs[a]&&(data.usr.langs[a]={exp:0,lvl:1}),data.usr.langs[a].exp+=e),cfg.workspace.trackLanguage&&a&&data.wsp&&(void 0===data.wsp.langs[a]&&(data.wsp.langs[a]={exp:0,lvl:1}),data.wsp.langs[a].exp+=e);var l=0,r=0,c=1/0,p=5;switch(levelTarget){case 1:data.usr.exp&&data.usr.lvl&&cfg.user.tracking&&(l=data.usr.exp,r=data.usr.lvl,p=usrMod,c=usrCap);break;case 2:data.wsp.exp&&data.wsp.lvl&&cfg.workspace.tracking&&(l=data.wsp.exp,r=data.wsp.lvl,p=wspMod,c=wspCap);break;case 3:0!=a&&data.usr.langs[a]&&data.usr.langs[a].exp&&data.usr.langs[a].lvl&&cfg.user.trackLanguage&&(l=data.usr.langs[a].exp,r=data.usr.langs[a].lvl,p=usrModLang,c=usrCapL);break;case 4:0!=a&&data.wsp.langs[a]&&data.wsp.langs[a].exp&&data.usr.langs[a].lvl&&cfg.workspace.trackLanguage&&(l=data.wsp.langs[a].exp,r=data.wsp.langs[a].lvl,p=wspModLang,c=wspCapL)}if(1==displayMode){let e=Math.min(r,c-1);t+=bar(e,p,l,displaySize)}if(2==displayMode){let e=Math.min(r,c-1),a=Math.min(levels.calculatePct(e,p,l,displayDeci-1),100),s=parseFloat(a).toFixed(displayDeci-1);if(Math.abs(a)<10){let e=s.toString();pctF="0"+e}else pctF=s;t+=pctF,t+="% | "}let i=!1;if((3==levelTarget&&!a||4==levelTarget&&!a)&&(i=!0),!i){if(1==levelMode&&r>0){let e=Math.min(r,c);t+="Lv. "+Math.min(e,c)}if(2==levelMode&&r>0){let e=Math.min(r,c);t+=Math.min(e,c)}if(3==levelMode&&r>0){let e=Math.min(r,c);switch(levelTarget){case 1:t+="ULv"+Math.min(e,c);break;case 2:t+="WLv"+Math.min(e,c);break;case 3:t+="ULL"+Math.min(e,c);break;case 4:t+="WLL"+Math.min(e,c)}}if(4==levelMode&&r>0){let e=Math.min(r,c);switch(levelTarget){case 1:t+="U"+Math.min(e,c);break;case 2:t+="W"+Math.min(e,c);break;case 3:t+="u"+Math.min(e,c);break;case 4:t+="w"+Math.min(e,c)}}if(5==levelMode&&r>0){let e=Math.min(r,c-1),a=Math.min(levels.calculatePct(e,p,l,levelDeci-1),100),s=parseFloat(a).toFixed(levelDeci-1);if(Math.abs(a)<10){let e=s.toString();pctF="0"+e}else pctF=s;t+=pctF,t+="%"}}if(cfg.status.levelReadySymbol&&r<c&&r>0){let e=levels.calculateReq(r,p);l>=e&&(t+=String(cfg.status.levelReadySymbolType))}if(status.text=t,cfg.tooltip.enableTooltip){if(cfg.tooltip.enableUser&&data.usr&&cfg.user.tracking){if(data.usr.lvl){let e=Math.min(data.usr.lvl,usrCap);s.value+="<b><u><code>User Lv. "+String(e)+"</code></u></b>"}if(data.usr.exp&&data.usr.lvl){let e,a=Math.min(data.usr.lvl,usrCap),t=data.usr.exp,l=levels.calculateReq(a-1,usrMod),r=levels.calculateReq(a,usrMod),c=number.format(t-l,numberStyle,!0),p=number.format(r-l,numberStyle,!0);if(e=a>=usrCap?"<b>MAX LEVEL</b>":"<b>"+String(c)+"</b> / "+String(p)+expSuffix,s.value+="<br>"+e,cfg.tooltip.enableUserTotal){let e=number.format(t,numberStyle,!0);s.value+="<br><code>"+String(e)+" total</code>"}}if(cfg.tooltip.enableUserLanguage&&data.usr.langs&&a&&cfg.user.trackLanguage&&data.usr.langs[a]&&data.usr.langs[a].exp&&data.usr.langs[a].lvl){let e,t=Math.min(data.usr.langs[a].lvl,usrCapL),l=levels.calculatePct(data.usr.langs[a].lvl,usrModLang,data.usr.langs[a].exp,0);e=t>=usrCapL?"MAX":Math.min(l,99)+"%";let r=nlang.prettify(a);s.value+="<br><i><b>"+r+"</b> Lv. "+String(t)+" ("+String(e)+")</i>"}}if(splitTooltip&&(s.value+="<br>═══════════════<br>"),cfg.tooltip.enableWorkspace&&data.wsp&&cfg.workspace.tracking){if(data.wsp.lvl){let e=Math.min(data.wsp.lvl,wspCap);s.value+="<b><u><code>Workspace Lv. "+String(e)+"</code></u></b>"}if(data.wsp.exp&&data.wsp.lvl){let e,a=Math.min(data.wsp.lvl,wspCap),t=data.wsp.exp,l=levels.calculateReq(a-1,wspMod),r=levels.calculateReq(a,wspMod),c=number.format(t-l,numberStyle,!0),p=number.format(r-l,numberStyle,!0);if(e=a>=wspCap?"<b>MAX LEVEL</b>":"<b>"+String(c)+"</b> / "+String(p)+expSuffix,s.value+="<br>"+e,cfg.tooltip.enableWorkspaceTotal){let e=number.format(t,numberStyle,!0);s.value+="<br><code>"+String(e)+" total</code>"}}if(cfg.tooltip.enableWorkspaceLanguage&&data.wsp.langs&&a&&cfg.workspace.trackLanguage&&data.wsp.langs[a]&&data.wsp.langs[a].exp&&data.wsp.langs[a].lvl){let e,t=Math.min(data.wsp.langs[a].lvl,wspCapL),l=levels.calculatePct(data.wsp.langs[a].lvl,wspModLang,data.wsp.langs[a].exp,0);e=t>=wspCapL?"MAX":Math.min(l,99)+"%";let r=nlang.prettify(a);s.value+="<br><i><b>"+r+"</b> Lv. "+String(t)+" ("+String(e)+")</i>"}}status.tooltip=s}}function bar(e,a=5,t,s=10){var l=0;let r=levels.calculateReq(e,a),c=levels.calculateReq(e-1,a),p=r-c,i=t-c;var g="▕";if(cfg.status.advancedBar){var n=8*s,u=s;for(let e=0;e<n;e++)i>=p/n*(e+1)&&l++;for(let e=0;e<Math.floor(l/8);e++)g+="█",u--;var o=l%8;switch(o){case 0:break;case 1:g+="▏",u--;break;case 2:g+="▎",u--;break;case 3:g+="▍",u--;break;case 4:g+="▌",u--;break;case 5:g+="▋",u--;break;case 6:g+="▊",u--;break;case 7:g+="▉",u--}for(let e=0;e<u;e++)g+="       ";return g+="▏",g}n=3*s,u=s;for(let e=0;e<n;e++)i>=p/n*(e+1)&&l++;for(let e=0;e<Math.floor(l/3);e++)g+="█",u--;o=l%3;switch(o){case 0:break;case 1:g+="▒",u--;break;case 2:g+="▓",u--}for(let e=0;e<u;e++)g+="▁";return g+="▏",g}const vc=require("vscode"),conf=require("./config.min.js"),data=require("./data.min.js"),number=require("./number.min.js"),levels=require("./levels.min.js"),nlang=require("./nicelang.min.js");let status;var cfg={};let displayMode=0,displayDeci=2,displaySize=10,levelMode=0,levelDeci=1,levelTarget=0,usrMod=10,usrModLang=5,wspMod=10,wspModLang=5,expSuffix="",usrCap=1/0,usrCapL=1/0,wspCap=1/0,wspCapL=1/0,splitTooltip=!1,numberStyle=1;module.exports={create:create,refresh:refresh,update:update,bar:bar};